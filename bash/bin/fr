#!/usr/bin/env bash

################################################################################
##                                                                            ##
##                               Usage Functions                              ##
##                                                                            ##
################################################################################

# Full help message
function fr_help() {
    echo "fr is a find/replace tool that uses a combination of find and sed in order" 1>&2
    echo "to replace string patterns with new ones in files." 1>&2
    fr_usage
}

# Usage message
function fr_usage() {
    echo "Usage:" 1>&2
    echo "    fr [options] [search pattern] [replace pattern]" 1>&2
    echo "Options:" 1>&2
    echo "    --dir | -d <directory path> " 1>&2
    echo "        the base directory to search in" 1>&2
    echo "    --file-pattern | -f <pattern>" 1>&2
    echo "        a file pattern to narrow down search results" 1>&2
    echo "    --search | -s <pattern>" 1>&2
    echo "        the pattern to search for in the file heirarchy" 1>&2
    echo "        (can also be entered as the first argument after all options)" 1>&2
    echo "    --replace | -r <string>" 1>&2
    echo "        the string to replace all matches with in the file heirarchy" 1>&2
    echo "        (can also be entered as the second argument after all options)" 1>&2
    echo "    --non-recursive | -n" 1>&2
    echo "        tell gref to only check the working directory for matches" 1>&2
    echo "    --max-depth | -M <int>        " 1>&2
    echo "        the maximum level of directories to recurse down when searching" 1>&2
    echo "    --min-depth | -m <int>        " 1>&2
    echo "        the minimum level of directories to recurse down when searching" 1>&2
    echo "    --help | -h                   " 1>&2
    echo "        print help message and exit" 1>&2
}


################################################################################
##                                                                            ##
##                               Exit Functions                               ##
##                                                                            ##
################################################################################

# Exit the program if the user requests help
function exit_if_help_requested() {
    if [[ "$1" == "--help" || "$1" == "-h" ]]; then
        gref_help
        exit 0
    fi
}

# Exit program if user doesn't supply correct input
function exit_if_input_incorrect() {
    if [[ "$#" -eq 0 || ("$#" -eq 1 && $1 =~ \-.*) ]]; then
        echoe "You must supply a search pattern"
        gref_usage
        exit 1
    fi
}

################################################################################
##                                                                            ##
##                             Supporting Functions                           ##
##                                                                            ##
################################################################################


# Used for printing errors:
function echoe () { echo -e "${RED}ERROR${NC}: $@" 1>&2 ; }

# Used for printing warnings:
function echow () { echo -e "${BROWN_ORANGE}WARNING${NC}: $@" 1>&2 ; }

################################################################################
##                                                                            ##
##                                  Variables                                 ##
##                                                                            ##
################################################################################

search_pattern=""
replace_pattern=""


################################################################################
##                                                                            ##
##                                 Main Program                               ##
##                                                                            ##
################################################################################

